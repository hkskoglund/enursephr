<!-- 
Copyright (c) 2008 Henning Knut Skoglund

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
-->

<!-- DateControls : Copyright (C) Kevin Moore 2007 j832.com, MIT Licence -->

<!-- CCC databases - Copyright (C) Sabacare Inc. 2007, 

Permission granted february 2008 for use in e-Nurse Care Planner *only*. In april 2008 e-Nurse Care Planner
changed name to eNurse Personal Health Record and the focus for development will be targated at
personal use. Derived products/applications must ask for 
permission to use databases  via Sabacare http://www.sabacare.com

Adapted for SQL Compact v3.5 by H. Skoglund february 2008

American v2.0 - electronically converted from .CSV/reference terminology
Korean v2.0 - manually converted from Word-document (not reviewed, may contain errors)
Norwegian v2.0 - manually converted from Word-document (not reviewed, may contain errors)
    
September 2008
Turkish v2.0 - - manually converted from Word-document (not reviewed, may contain errors)
    

Recommended use at the moment: research/testing-purposes

-->

<!-- Language changes are marked with LANGUAGE attrib --> 
<Window x:Class="eNursePHR.userInterfaceLayer.WindowMain"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
    xmlns:dat="clr-namespace:System.Windows.Data;assembly=PresentationFramework"
    xmlns:annot="clr-namespace:System.Windows.Annotations;assembly=PresentationFramework"
    xmlns:ui="clr-namespace:eNursePHR.userInterfaceLayer"
        
        
    xmlns:dc="clr-namespace:Microsoft.Samples.KMoore.WPFSamples.DateControls;assembly=J832.Wpf.BagOTricksLib"
    xmlns:ac="clr-namespace:AC.AvalonControlsLibrary.Controls;assembly=AvalonControlsLibrary"
   
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d" 

    Title="eNurse Personal Health Record - prototype"   
    Loaded="Window_Loaded" 
    SizeToContent="Height" 
    Closing="Window_Closing" 
    WindowStyle="SingleBorderWindow" Height="423.383" Width="1108"
    WindowStartupLocation="CenterScreen"
    
    x:Name="wndMain" >
    <Window.Resources>
    
    <!-- Converters -->
       
        <ui:DateTimeConverter x:Key="DateTimeConverter" />
		<ui:TitleConverter x:Key="TitleConverter" />
		<ui:RemoveParentesisOutcomeConceptConverter x:Key="RemoveParentesisOutcomeConceptConverter" />
		<ui:UpperCaseConverter x:Key="UpperCaseConverter" />
        
		<ui:HighlightTextConverter x:Key="HighlightTextConverter" />
		<ui:StatementContentConverter x:Key="StatementContentConverter" />
		<ui:StatementContentTypeConverter x:Key="StatementContentTypeConverter" />
		<ui:ValidContentConverter x:Key="ValidContentConverter" />
		<ui:AnnotationToolTipConverter x:Key="AnnotationToolTipConverter" />
        <ui:RoundSliderConverter x:Key="RoundSliderConverter" />
      
        <!--<ui:ConvertXmlElementToXmlDocument x:Key="ConvertXmlElementToXmlDocument" />-->

		<!-- Based on http://adoguy.com/2007/04/17/Changing_the_Selected_Style_of_ListBox_s_in_XAML.aspx, accessed 20 march 08-->
		<Style x:Key="GreenItemContainer"  TargetType="{x:Type ListViewItem}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type ListViewItem}">
						<Border 
                    CornerRadius="8"
                    BorderThickness="1"
                    Background="White"
                    x:Name="IconBorder"
                    Margin="8,4,8,4"
                    Padding="5" >
							<ContentPresenter />
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsSelected" Value="true">
								<Setter TargetName="IconBorder" Property="BitmapEffect">
									<Setter.Value>
										<OuterGlowBitmapEffect GlowColor="Green"  GlowSize="8" />
									</Setter.Value>
								</Setter>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>



		<DataTemplate x:Key="CareComponentHeader">
			<TextBlock Text="{Binding Path=Name, Converter={StaticResource UpperCaseConverter}}" 
			FontSize="13"
			 FontWeight="UltraBold" 
			 HorizontalAlignment="Center" 
			 Foreground="{StaticResource CareComponentColor}"
			 />
        </DataTemplate>

		<DataTemplate x:Key="TagDisplay">


			<!--<Grid>
                     <Grid.ColumnDefinitions>
						<ColumnDefinition Width="*" />
                     </Grid.ColumnDefinitions>-->
				<Grid>
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="*" />
					</Grid.ColumnDefinitions>
					<Grid.RowDefinitions>
						<RowDefinition  />
						<RowDefinition  />

					</Grid.RowDefinitions>

					<StackPanel Grid.Row="0"  >

						<StackPanel Orientation="Horizontal">
							<StackPanel x:Name="spActionTypeModifier" Orientation="Horizontal" Visibility="Collapsed">
								<TextBlock Text="{dat:Binding Path=ActionT.SingleConcept}" Foreground="{StaticResource InterventionColor}" Margin="0,0,5,0" VerticalAlignment="Center" />
									        <!--<TextBlock x:Name="tbDelimiter" Text=" - " Foreground="Blue"/>-->
		                    </StackPanel>
							<TextBlock  x:Name="tbTagConcept"
												  Text="{dat:Binding Path=Concept}" 
												  ToolTip="{dat:Binding Path=Definition}"
												  FontWeight="UltraBold" 
												  Width="200"
												  TextWrapping="Wrap"
												 />
									   </StackPanel>

						<StackPanel x:Name="spOutcomeQualifier" Orientation="Horizontal" >
							<TextBlock Text="will " />
									         <TextBlock x:Name="tbLatestOutcomeModifier" 
									      Text="{Binding Path=LatestOutcomeModifier, Converter={StaticResource RemoveParentesisOutcomeConceptConverter}}" 
									      Foreground="{StaticResource DiagnosisColor}" Margin="0,0,5,0" 
									      />
									         <Image  x:Name="imgLatestOutcome" Height="15" />
									   </StackPanel>

					</StackPanel>

					<TextBox Grid.Row="1" 
					  x:Name="tbTagComment" 
					  Text="{dat:Binding Path=Comment, UpdateSourceTrigger=PropertyChanged}" 
                                  
                                  FontStyle="Italic"
                                  TextWrapping="Wrap" 
                                  HorizontalAlignment="Left"
                                  TextChanged="tbTagComment_TextChanged"
                                  Width="220"
                                    />


				</Grid>
			<!--</Grid>-->


			<DataTemplate.Triggers>
				<DataTrigger Binding="{dat:Binding Path=LatestOutcome}" Value="1">
					<Setter TargetName="imgLatestOutcome" Property="Source" Value="Outcome Types\Improved.png" />
				</DataTrigger>
				<DataTrigger Binding="{dat:Binding Path=LatestOutcome}" Value="2">
					<Setter TargetName="imgLatestOutcome" Property="Source" Value="Outcome Types\Stabilized.png" />
				</DataTrigger>
				<DataTrigger Binding="{dat:Binding Path=LatestOutcome}" Value="3">
					<Setter TargetName="imgLatestOutcome" Property="Source" Value="Outcome Types\Worsened.png" />
				</DataTrigger>

				<DataTrigger Binding="{dat:Binding Path=TaxonomyType}" Value="CCC/NursingDiagnosis">
					<Setter Property="Foreground" TargetName="tbTagConcept" Value="{StaticResource DiagnosisColor}" />
				</DataTrigger>

				<DataTrigger Binding="{dat:Binding Path=TaxonomyType}" Value="CCC/NursingIntervention">
					<Setter Property="Foreground" TargetName="tbTagConcept" Value="{StaticResource InterventionColor}" />
					<Setter Property="Visibility" TargetName="spActionTypeModifier" Value="Visible" />
				</DataTrigger>

				<!--<DataTrigger Binding="{dat:Binding Path=ActionT.SingleConcept}" Value="{x:Null}">
							<Setter Property="Visibility" TargetName="tbDelimiter" Value="Collapsed" />
                       </DataTrigger>-->

				<DataTrigger Binding="{dat:Binding Path=LatestOutcomeModifier}" Value="{x:Null}">
					<Setter Property="Visibility" TargetName="spOutcomeQualifier" Value="Collapsed" />
				</DataTrigger>

				<DataTrigger Binding="{dat:Binding Path=TaxonomyType}" Value="CCC/CareComponent">
					<Setter Property="Foreground" TargetName="tbTagConcept" Value="{StaticResource CareComponentColor}" />
				</DataTrigger>
			</DataTemplate.Triggers>

		</DataTemplate>


		<!--
        <ObjectDataProvider ObjectType="business:AllCareComponents"   x:Key="all" />
        
        <CollectionViewSource Source="{Binding Source={StaticResource all}, Path=CareComponents}" x:Key="cvs">
            <CollectionViewSource.SortDescriptions>
                <scm:SortDescription PropertyName="Component"/>
            </CollectionViewSource.SortDescriptions>
            <CollectionViewSource.GroupDescriptions>
                <dat:PropertyGroupDescription PropertyName="Pattern"/>
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
-->
        

        <DataTemplate x:Key="detailsCareComponent">
            <StackPanel>
                
                 
                <TextBlock Text="{dat:Binding Path=Definition}"  />
            </StackPanel>
        </DataTemplate>


        <ui:DateConverter x:Key="DateConverter"/>

        <DataTemplate x:Key="ccTemplateDiagnosisAndIntervention">

            <StackPanel>
                <TextBlock x:Name="tbTemplateConceptActionType" Text="{dat:Binding Path=Concept}" 
                HorizontalAlignment="Left" 
                FontWeight="UltraBold" TextWrapping="Wrap" ToolTip="{dat:Binding Path=Definition}" />
              <!--  <TextBlock Text="{Binding Path=Definition}" HorizontalAlignment="Left"  TextWrapping="Wrap" /> -->
            </StackPanel>

        </DataTemplate>

		<DataTemplate x:Key="ccTemplateOutcomeType">

			<StackPanel Orientation="Horizontal">
				<TextBlock Text="will" Margin="0,0,5,0" />
				<TextBlock x:Name="tbTemplateConceptOutcomeType" Text="{dat:Binding Path=Concept, Converter={StaticResource RemoveParentesisOutcomeConceptConverter}}" 
                HorizontalAlignment="Left"  Foreground="{StaticResource DiagnosisColor}"
                FontWeight="UltraBold" TextWrapping="Wrap" ToolTip="{dat:Binding Path=Definition}" />
               <!-- <TextBlock Text="{Binding Path=Definition}" HorizontalAlignment="Left"  TextWrapping="Wrap" /> -->
            </StackPanel>

		</DataTemplate>



		<SolidColorBrush x:Key="FrameworkElementBorderSelected" Color="Yellow" />
        
        <SolidColorBrush x:Key="FrameworkElementBorder" Color="White" />
    	
    	<!--<Storyboard x:Key="StoryboardAnimateCarePlan">
    		<ColorAnimationUsingKeyFrames BeginTime="00:00:00" RepeatBehavior="Forever" Storyboard.TargetName="spActiveCarePlan" Storyboard.TargetProperty="(Panel.Background).(GradientBrush.GradientStops)[1].(GradientStop.Color)">
    			<SplineColorKeyFrame KeyTime="00:00:00" Value="#FF0038FB"/>
    			<SplineColorKeyFrame KeyTime="00:00:02" Value="#FF0038FB"/>
    		</ColorAnimationUsingKeyFrames>
    		<DoubleAnimationUsingKeyFrames RepeatBehavior="Forever" BeginTime="00:00:00" Storyboard.TargetName="spActiveCarePlan" Storyboard.TargetProperty="(Panel.Background).(GradientBrush.GradientStops)[0].(GradientStop.Offset)">
    			<SplineDoubleKeyFrame KeyTime="00:00:00" Value="0"/>
    			<SplineDoubleKeyFrame KeyTime="00:00:00.9000000" Value="0"/>
    			<SplineDoubleKeyFrame KeyTime="00:00:02" Value="0"/>
    		</DoubleAnimationUsingKeyFrames>
    		<ColorAnimationUsingKeyFrames RepeatBehavior="Forever" BeginTime="00:00:00" Storyboard.TargetName="spActiveCarePlan" Storyboard.TargetProperty="(Panel.Background).(GradientBrush.GradientStops)[0].(GradientStop.Color)">
    			<SplineColorKeyFrame KeyTime="00:00:00" Value="#FFF5F5F8"/>
    			<SplineColorKeyFrame KeyTime="00:00:02" Value="#FFF5F5F8"/>
    		</ColorAnimationUsingKeyFrames>
    		<StringAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="textBlock" Storyboard.TargetProperty="(TextBlock.Text)">
    			<DiscreteStringKeyFrame KeyTime="00:00:00" Value="Active Care plan"/>
    		</StringAnimationUsingKeyFrames>
    		<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="spActiveCarePlan" Storyboard.TargetProperty="(Panel.Background).(GradientBrush.GradientStops)[1].(GradientStop.Offset)">
    			<SplineDoubleKeyFrame KeyTime="00:00:00" Value="1"/>
    			<SplineDoubleKeyFrame KeyTime="00:00:00.9000000" Value="0.593"/>
    		</DoubleAnimationUsingKeyFrames>
    	</Storyboard>-->

        <SolidColorBrush x:Key="colorSystolic" Color="Magenta" />
        <SolidColorBrush x:Key="colorDiastolic" Color="DarkBlue" />
        <SolidColorBrush x:Key="colorPulse" Color="Red" />
        <SolidColorBrush x:Key="colorHighSBP" Color="Black" />
        <SolidColorBrush x:Key="colorHighDBP" Color="Black" />



    </Window.Resources>
	<Window.Triggers>
		<!--<EventTrigger RoutedEvent="FrameworkElement.Loaded">
			<BeginStoryboard Storyboard="{StaticResource StoryboardAnimateCarePlan}"/>
		</EventTrigger>-->

	</Window.Triggers>
 
    
    <StackPanel Background="{StaticResource BlueTheme}">

     
      <DockPanel >  
        <Menu DockPanel.Dock="Left">
                <MenuItem Header="Report">
                    <MenuItem x:Name="miCarePlanBlog" Header="Show Blog" Click="miCarePlanBlog_Click" />
                </MenuItem>
                <MenuItem Header="Terminology">
                    <MenuItem x:Name="miTerminologyCheck" Header="Check Integrity" Click="MenuItemLanguageIntegrity_Click" />
            	   
                </MenuItem>
                <MenuItem Header="About"  Click="MenuItemOm_Click" />
               
            </Menu>
            
             <!-- Active care plan -->
           
             <!--<StackPanel  DockPanel.Dock="Right" Orientation="Horizontal" x:Name="spActiveCarePlan">
             	<StackPanel.Background>
             		<LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
             			<GradientStop Color="#FFF5F5F8" Offset="0"/>
             			<GradientStop Color="#FF0038FB" Offset="1"/>
             		</LinearGradientBrush>
             	</StackPanel.Background>
             
             <TextBlock Margin="5,0,0,0" Text="Care plan" TextAlignment="Center"
                        FontSize="15" 
                        FontWeight="UltraBold" 
                        VerticalAlignment="Center" HorizontalAlignment="Stretch" 
                        Background="{x:Null}" x:Name="textBlock"
                  />
         </StackPanel>-->
         
        </DockPanel>
        
        
        
         <ToolBarTray >
         <ToolBar>
					<StackPanel Orientation="Horizontal">
						
						<Button x:Name="btnDisease"  
						Height="15" Width="15"
						ToolTip="Gather information that can be characterised as a disease" 
						Background="{StaticResource DiseaseColor}" 
						Foreground="White" 
						FontWeight="UltraBold"  Click="btnCaptureDiseaseStatement_Click" />
						
						<Button x:Name="btnDiagnosis" 
						 Height="15" Width="15"
						 ToolTip="Gather information that can be characterised as diagnostic" Background="{StaticResource DiagnosisColor}" Foreground="White" FontWeight="UltraBold"  Click="btnCaptureDiagnosticStatement_Click" />
						
						<Button x:Name="btnIntervention" 
						Height="15" Width="15"
						ToolTip="Gather information that can be characterised as interventional" 
						Background="{StaticResource InterventionColor}" 
						Foreground="White" FontWeight="UltraBold" Click="btnCaptureInterventionalStatement_Click" />
						
						<Button x:Name="btnMedication" 
						Height="15" Width="15"
						ToolTip="Gather information that can be characterised as medicational" 
						Background="{StaticResource MedicationColor}" 
						Foreground="White" FontWeight="UltraBold" Click="btnCaptureMedicationalStatement_Click" />
						
						<Button Command="annot:AnnotationService.ClearHighlightsCommand" ToolTip="Removes selected annotations" >
							<Image Height="15" Source="Images/Cut.png">
							<Image.RenderTransform>
								<RotateTransform Angle="-90" CenterX="7.5" CenterY="7.5" />
							</Image.RenderTransform>
							</Image>
						</Button>
					
					</StackPanel>

			</ToolBar>
         
         
                  <ToolBar>
                       
                       <Button Click="btnBack_Click">
                          <Image Source="Images\ArrowBack.png" Height="20" ToolTip="Previous entry"/>
                       </Button>
                       
                       <Button Click="btnForward_Click">
                          <Image Source="Images\ArrowForward.png" Height="20" ToolTip="Next entry"/>
                       </Button>
                       
                        <Button x:Name="btnHome" Click="btnHome_Click">
                          <Image Source="Images\Home.png" Height="20" ToolTip="Return to selected entry"/>
                       </Button>
                      
                      <Button x:Name="btnSaveTagComments" ToolTip="Save tag comments" Visibility="Collapsed" Click="btnSaveTagComments_Click">
			           	<Image Source="\Images\Save.png" Height="15" Margin="5,0,5,0" />
                      </Button>
                       
                       <Button Click="btnNewItem_Click">
                         <Image Source="Images\New.png" Height="20" ToolTip="New entry" />
                       </Button>
                       
                       <Button Click="btnDeleteItem_Click">
                          <Image Source="Images\Delete.png" Height="20" ToolTip="Delete selected entry"/>
                       </Button>
                       
                       <Button  x:Name="btnFullScreen" Click="btnFullScreen_Click">
                          <Image Source="Images\FullScreen.png" Height="20" ToolTip="Toogle fullscreen display"/>
                       </Button>
                       
                       
                  </ToolBar>
                  
                  
                  <ToolBar>
                   <!-- CareBlog -->
                                    
             <ComboBox x:Name="lvCareBlog" MaxHeight="100"
                                     MouseDoubleClick="lvCareBlog_MouseDoubleClick"
                                     SelectionChanged="lvCareBlog_SelectionChanged"
                                      HorizontalContentAlignment="Left"
                                     AllowDrop="True"
                                     Drop="lvCareBlog_Drop"
                                     IsSynchronizedWithCurrentItem="True">
         <!--<ListView.View>

                    <GridView x:Name="gvView" AllowsColumnReorder="True"   >

                        
                        <GridViewColumn x:Name="gvcContent"
                                        Header="Content" 
                                        Width="35"
                                          >

                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                   <StackPanel Orientation="Horizontal">
                                    <TextBlock x:Name="tbContainsCareComponent" Text="  " Visibility="Collapsed" />
                                    <TextBlock x:Name="tbContainsDiagnosis" Text="  " Visibility="Collapsed" />
                                    <TextBlock x:Name="tbContainsIntervention" Text="  " Visibility="Collapsed" />
                                    <TextBlock x:Name="tbContainsFolksonomy" Text="  " Visibility="Collapsed" />
                                   
                                   </StackPanel>    
                                   <DataTemplate.Triggers>
                                       <DataTrigger Binding="{Binding Path=ContainsCareComponent}" Value="True">
                                           <Setter TargetName="tbContainsCareComponent" Property="Background" Value="Magenta" />
                                           <Setter TargetName="tbContainsCareComponent" Property="Visibility" Value="Visible" />
                                       </DataTrigger>

                                       <DataTrigger Binding="{Binding Path=ContainsDiagnosis}" Value="True">
                                           <Setter TargetName="tbContainsDiagnosis" Property="Background" Value="Green" />
                                           <Setter TargetName="tbContainsDiagnosis" Property="Visibility" Value="Visible" />
                                       </DataTrigger>
                                       <DataTrigger Binding="{Binding Path=ContainsIntervention}" Value="True">
                                           <Setter TargetName="tbContainsIntervention" Property="Background" Value="Blue" />
                                           <Setter TargetName="tbContainsIntervention" Property="Visibility" Value="Visible" />
                                       </DataTrigger>
                                       <DataTrigger Binding="{Binding Path=ContainsFolksonomy}" Value="True">
                                           <Setter TargetName="tbContainsFolksonomy" Property="Background" Value="Yellow" />
                                           <Setter TargetName="tbContainsFolksonomy" Property="Visibility" Value="Visible" />
                                       </DataTrigger>

                                   </DataTemplate.Triggers>  
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>

                        </GridViewColumn>
                        
                        <GridViewColumn x:Name="gvcTitle"
                                        Header="Title" 
                                        Width="150" 
                                          >

                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                     <TextBlock Text="{Binding Path=Title}" TextWrapping="Wrap"/>
                                 </DataTemplate>
                            </GridViewColumn.CellTemplate>

                        </GridViewColumn>
                        
                         <GridViewColumn x:Name="gvcCreatedDate" Header="Created date"
                      Width="100" >

                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Path=History.CreatedDate, Converter={StaticResource DateTimeConverter}}" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>

                        </GridViewColumn>
                        
                        <GridViewColumn x:Name="gvcCreatedBy" Header="Created by"
                      Width="90" >

                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Path=History.CreatedBy}" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>

                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcUpdatedDate" Header="Last update"
                      Width="100" >

                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Path=History.UpdatedDate, Converter={StaticResource DateTimeConverter}}" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>

                        </GridViewColumn>
                        
                        <GridViewColumn x:Name="gvcUpdatedBy" Header="Updated by"
                      Width="90" >

                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Path=History.UpdatedBy}" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>

                        </GridViewColumn>


                     
                    </GridView>

                </ListView.View>-->
                               
                 <ComboBox.ItemTemplate>
                     <DataTemplate>
                                    <Border x:Name="bItem" BorderThickness="0" CornerRadius="5"
                                            BorderBrush="LightGray" 
                                            Width="400"
                                            Margin="2"
                                            Padding="3">
                                         <StackPanel Orientation="Horizontal" >
                                            <TextBlock x:Name="tbContainsCareComponent" Text="  " Visibility="Collapsed" />
                                             <TextBlock x:Name="tbContainsDiagnosis" Text="  " Visibility="Collapsed" />
                                             <TextBlock x:Name="tbContainsIntervention" Text="  " Visibility="Collapsed" />
                                              <TextBlock x:Name="tbContainsFolksonomy" Text="  " Visibility="Collapsed" />
                                            <TextBlock Margin="5,0,0,0" Text="{dat:Binding Path=Title, Converter={StaticResource TitleConverter}}" ToolTip="{dat:Binding Path=Title}"  FontWeight="UltraBold" TextWrapping="Wrap"/>
                                            <!--<TextBlock Margin="5,0,0,0" Text="{dat:Binding Path=History.LastUpdate, Converter={StaticResource DateTimeConverter}}" />
                                            <TextBlock Margin="5,0,0,0" Text="{dat:Binding Path=History.LastUpdater}" />-->
                                          </StackPanel>
                                            
                                     </Border>
                         <DataTemplate.Triggers>
                                   <DataTrigger Binding="{dat:Binding Path=ContainsCareComponent}" Value="True">
                                           <Setter TargetName="tbContainsCareComponent" Property="Background" Value="{StaticResource CareComponentColor}" />
                                           <Setter TargetName="tbContainsCareComponent" Property="Visibility" Value="Visible" />
                                   </DataTrigger>

                                       <DataTrigger Binding="{dat:Binding Path=ContainsDiagnosis}" Value="True">
                                           <Setter TargetName="tbContainsDiagnosis" Property="Background" Value="{StaticResource DiagnosisColor}" />
                                           <Setter TargetName="tbContainsDiagnosis" Property="Visibility" Value="Visible" />
                                      
                                       </DataTrigger>
                                       <DataTrigger Binding="{dat:Binding Path=ContainsIntervention}" Value="True">
                                           <Setter TargetName="tbContainsIntervention" Property="Background" Value="{StaticResource InterventionColor}" />
                                           <Setter TargetName="tbContainsIntervention" Property="Visibility" Value="Visible" />
                            
                                       </DataTrigger>
                                       <DataTrigger Binding="{dat:Binding Path=ContainsFolksonomy}" Value="True">
                                           <Setter TargetName="tbContainsFolksonomy" Property="Background" Value="Yellow" />
                                           <Setter TargetName="tbContainsFolksonomy" Property="Visibility" Value="Visible" />
                                       </DataTrigger>
                                       
                                       <!--<DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorType={x:Type ComboBoxItem}},Path=IsSelected}" Value="True">
                                           <Setter TargetName="spItemHistory" Property="Visibility" Value="Visible" />
                                       </DataTrigger>-->
                                     
                         </DataTemplate.Triggers>
                     </DataTemplate>
                 </ComboBox.ItemTemplate>
                 <!--<ListView.ItemsPanel>
                     <ItemsPanelTemplate>
                         <WrapPanel MaxWidth="500" />
                     </ItemsPanelTemplate>
                 </ListView.ItemsPanel>-->
             </ComboBox>
             
                             
                  </ToolBar>
                  <ToolBar>
                  
                  	<ComboBox x:Name="cbLanguage" Width="60" 
											   SelectionChanged="cbLanguage_SelectionChanged"
											   VerticalAlignment="Top">
					<ComboBox.ItemTemplate>
						<DataTemplate>
							<StackPanel Orientation="Horizontal">
							   <Image x:Name="imgFlagCombo" Width="40" />
							   <!--<Image x:Name="imgPassed" Margin="5,0,0,0" Width="10" VerticalAlignment="Center" />-->
							  </StackPanel>
							<DataTemplate.Triggers>
                                
                                <!-- Norwegian -->
								<DataTrigger Binding="{dat:Binding Path=Language_Name}" Value="nb-NO">
									<Setter Property="Source" Value="Flags/nb-No.gif" TargetName="imgFlagCombo" />
	                             
								</DataTrigger>
                                
                                <!-- American -->
								<DataTrigger Binding="{dat:Binding Path=Language_Name}" Value="en-US">
									<Setter Property="Source" Value="Flags/en-US.gif" TargetName="imgFlagCombo" />
	                               
								</DataTrigger>
								
                                <!-- Korean -->
                                <DataTrigger Binding="{dat:Binding Path=Language_Name}" Value="ko-KR">
									<Setter Property="Source" Value="Flags/ko-KR.gif" TargetName="imgFlagCombo" />
	                             
								</DataTrigger>

                                <!-- Turkish -->
                                <DataTrigger Binding="{dat:Binding Path=Language_Name}" Value="tr-TR">
                                    <Setter Property="Source" Value="Flags/tr-TR.gif" TargetName="imgFlagCombo" />

                                </DataTrigger>
                                
                                <DataTrigger Binding="{dat:Binding Path=ValidShallow}" Value="True">
									<Setter Property="ToolTip" Value="Passed language integrity shallow test (everthing as the expected count)" TargetName="imgFlagCombo" />
								  <!--<Setter Property="Source" Value="Images/OK.png" TargetName="imgPassed" />-->
	                           
								 </DataTrigger>
								<DataTrigger Binding="{dat:Binding Path=ValidShallow}" Value="False">
									<Setter Property="ToolTip" Value="Did not pass the language integrity shallow test (something not as the expected count) " TargetName="imgFlagCombo" />
								  <!--<Setter Property="Source" Value="Images/ERROR.png" TargetName="imgPassed" />-->
	                           
								</DataTrigger>

	                            
							</DataTemplate.Triggers>
						</DataTemplate>

					</ComboBox.ItemTemplate>

				</ComboBox>
				
				<StackPanel Orientation="Horizontal"  >
                        <!-- LANGAUGE attrib change
                                                Norwegian : Søk
                                                English : Search -->
                        <Label HorizontalAlignment="Left" Foreground="#FF000000" VerticalAlignment="Center" Content="Search :"/>
                        <TextBox Width="100" x:Name="tbSearch" TextChanged="tbSearch_TextChanged" VerticalContentAlignment="Center" VerticalAlignment="Center"  />
                    </StackPanel>
						
                  </ToolBar>
             </ToolBarTray>

        <TabControl>
            <TabItem x:Name="tabPHR" Header="Health Diary"> 
                <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1.7*" x:Name="gcCareBlog" />
                    <ColumnDefinition Width="Auto" />
                    <!-- Grid Splitter-->
                    <ColumnDefinition Width="1.2*" x:Name="gcTags"/>
                    <ColumnDefinition Width="Auto" />
                    <!-- Grid Splitter-->
                    <ColumnDefinition Width="1.1*" x:Name="gcTaxonomy"/>

                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition />
                </Grid.RowDefinitions>


                <Grid Grid.Column="0" Background="White">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <!--<RowDefinition Height="Auto" />-->
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Careplan item-->
                    <FlowDocumentReader Grid.Row="0" Grid.Column="0"  x:Name="fdReaderCareBlog" 
          Margin="5" IsPrintEnabled="True"  ScrollViewer.VerticalScrollBarVisibility="Auto"
          MaxHeight="600" VerticalAlignment="Top" />

                </Grid>

                <GridSplitter Grid.Column="1" Grid.Row="0" Width="1" Background="LightGray" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />

                <ScrollViewer  Grid.Row ="0" Grid.Column="2" 
     ScrollViewer.VerticalScrollBarVisibility="Auto" MaxHeight="600" >
                    <StackPanel>

                        <!-- Annotations -->

                        <Expander x:Name="exAnnotation" IsExpanded="False"
         Background="{StaticResource BlueTheme}"
         Padding="5">
                            <Expander.Header>
                                <TextBlock Text="Information acquisition" FontSize="13" FontWeight="UltraBold" />
           </Expander.Header>


                            <ListView x:Name="lvAnnotation" Grid.Row="2" 
           IsSynchronizedWithCurrentItem="True"
				SelectionChanged="lvAnnotation_SelectionChanged"
				  ItemContainerStyle="{StaticResource GreenItemContainer}"
				  Style="{DynamicResource ListViewStyleInformationAcquired}"
		       >
                                <ListView.Resources>

                                    <SolidColorBrush x:Key="ListBorder" Color="#FF7F9DB9"/>
                                    <Style x:Key="ListViewStyleInformationAcquired" TargetType="{x:Type ListView}">
                                        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"/>
                                        <Setter Property="BorderBrush" Value="{StaticResource ListBorder}"/>
                                        <Setter Property="BorderThickness" Value="1"/>
                                        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                                        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
                                        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
                                        <Setter Property="ScrollViewer.CanContentScroll" Value="true"/>
                                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type ListView}">
                                                    <StackPanel>
                                                        <Border x:Name="Bd" SnapsToDevicePixels="true" Background="{TemplateBinding Background}" 
							BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="1">
                                                            <ScrollViewer Padding="{TemplateBinding Padding}" Focusable="false">
                                                                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                                            </ScrollViewer>
                                                        </Border>
                                                        <TextBlock Text="No information acquired" x:Name="tbEmpty" Visibility="Collapsed" ToolTip="Use annotation highlights/markup to gather information about diagnoses and interventions that are relevant for coding via the taxonomy" />
						   </StackPanel>
                                                    <ControlTemplate.Triggers>
                                                        <DataTrigger Binding="{Binding Path=Items.Count,

            RelativeSource={RelativeSource Self}}" Value="0">

                                                            <Setter TargetName="tbEmpty" Property="Visibility" 

              Value="Visible" />
                                                            <Setter TargetName="Bd" Property="Visibility" Value="Collapsed" />

                                                        </DataTrigger>
                                                        <Trigger Property="IsEnabled" Value="false">
                                                            <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
                                                        </Trigger>
                                                        <Trigger Property="IsGrouping" Value="true">
                                                            <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ListView.Resources>

                                <!--<ListView.View>
			
				<GridView>-->


                                <!--<GridViewColumn Header="Authors" Width="120">
						<GridViewColumn.CellTemplate>
							<DataTemplate>
								<StackPanel>
									<ComboBox x:Name="cbAuthors" ItemsSource="{Binding Authors, Mode=OneWay}" SelectedIndex="0"  />
								   <TextBlock x:Name="tbAuthorsNotSpecified" Text="No authors specified" Visibility="Collapsed" />
								</StackPanel>
								
								<DataTemplate.Triggers>
									<DataTrigger Binding="{Binding Path=Authors.Count}" Value="0">
											<Setter Property="Visibility" TargetName="cbAuthors" Value="Collapsed" />
										<Setter Property="Visibility" TargetName="tbAuthorsNotSpecified" Value="Visible" />
									</DataTrigger>
								</DataTemplate.Triggers>
							</DataTemplate>
						</GridViewColumn.CellTemplate>
					</GridViewColumn>
					
					
					<GridViewColumn Header="Created" Width="130">
						<GridViewColumn.CellTemplate>
							<DataTemplate>
								<TextBlock  Text="{Binding CreationTime, Mode=OneWay}"  />
							</DataTemplate>
						</GridViewColumn.CellTemplate>
					</GridViewColumn>
					
					<GridViewColumn Header="Last modification" Width="130">
						<GridViewColumn.CellTemplate>
							<DataTemplate>
								<TextBlock Text="{Binding LastModificationTime, Mode=OneWay}"  />
							</DataTemplate>
						</GridViewColumn.CellTemplate>
					</GridViewColumn>

					<GridViewColumn Header="Content" Width="130">
						<GridViewColumn.CellTemplate>
							<DataTemplate>
								<TextBlock Text="{Binding ., Mode=OneWay, Converter={StaticResource HighlightTextConverter}}"  />
							</DataTemplate>
						</GridViewColumn.CellTemplate>
					</GridViewColumn>-->

                                <!--<GridViewColumn Width="130">
		
						<GridViewColumn.CellTemplate>
						
							<DataTemplate>
								
									<TextBlock x:Name="tbAnnotationContent" Text="{Binding Path=Anchors[0].Contents[0].OuterXml, Converter={StaticResource StatementContentConverter}}"  />
				
				<DataTemplate.Triggers>
					<DataTrigger Binding="{Binding Path=Anchors[0].Contents[0].OuterXml, Converter={StaticResource StatementContentTypeConverter}}" Value="Diagnosis">
						<Setter Property="Foreground" TargetName="tbAnnotationContent" Value="{StaticResource DiagnosisColor}" />
					</DataTrigger>

					<DataTrigger Binding="{Binding Path=Anchors[0].Contents[0].OuterXml, Converter={StaticResource StatementContentTypeConverter}}" Value="Intervention">
						<Setter Property="Foreground" TargetName="tbAnnotationContent" Value="{StaticResource InterventionColor}" />
					</DataTrigger>

				</DataTemplate.Triggers>
				
						
							</DataTemplate>
						</GridViewColumn.CellTemplate>
					</GridViewColumn>




				</GridView>
			</ListView.View>-->

                                <ListView.ItemTemplate>
                                    <DataTemplate>

                                        <StackPanel Orientation="Horizontal">
                                            <StackPanel.BitmapEffect>
                                                <OuterGlowBitmapEffect GlowSize="0" />
                                            </StackPanel.BitmapEffect>
                                            <Image x:Name="imgInvalidContent" Height="6" VerticalAlignment="Center" Source="/Images/ERROR.png" Visibility="Collapsed" Margin="0,0,5,0" />
                                            <TextBlock TextWrapping="Wrap" x:Name="tbAnnotationContent" 
						    MaxWidth="200" 
							FontWeight="UltraBold"
						    Text="{Binding Path=Anchors[0].Contents[0].OuterXml, Converter={StaticResource StatementContentConverter}}"
						    ToolTip="{Binding ., Converter={StaticResource AnnotationToolTipConverter}}"  />
						 
						  
						  
						    <!--<TextBlock TextWrapping="Wrap" x:Name="tbAnnotationContent" 
						    MaxWidth="200" 
						    Text="{Binding XPath=Statement[1]/@Content}"
						    DataContext="{Binding Path=Anchors[0].Contents[0]}"
						     />-->
						    
						 </StackPanel>

                                        <DataTemplate.Triggers>
                                            <DataTrigger Binding="{Binding Path=Anchors[0].Contents[0].OuterXml, Converter={StaticResource StatementContentTypeConverter}}" Value="Diagnostic">

                                                <Setter Property="Foreground" TargetName="tbAnnotationContent" Value="{StaticResource DiagnosisColor}" />
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding Path=Anchors[0].Contents[0].OuterXml, Converter={StaticResource StatementContentTypeConverter}}" Value="Interventional">
                                                <Setter Property="Foreground" TargetName="tbAnnotationContent" Value="{StaticResource InterventionColor}" />
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding Path=Anchors[0].Contents[0].OuterXml, Converter={StaticResource StatementContentTypeConverter}}" Value="Disease">
                                                <Setter Property="Foreground" TargetName="tbAnnotationContent" Value="{StaticResource DiseaseColor}" />
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding Path=Anchors[0].Contents[0].OuterXml, Converter={StaticResource StatementContentTypeConverter}}" Value="Medication">
                                                <Setter Property="Foreground" TargetName="tbAnnotationContent" Value="{StaticResource MedicationColor}" />
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding ., Converter={StaticResource ValidContentConverter}}" Value="False">
                                                <Setter Property="Visibility" TargetName="imgInvalidContent" Value="Visible" />
                                            </DataTrigger>


                                        </DataTemplate.Triggers>


                                    </DataTemplate>
                                </ListView.ItemTemplate>

                            </ListView>

                        </Expander>

                        <!-- Tags -->
                        <Expander  x:Name="exTags" IsExpanded="True"
                  Background="{StaticResource BlueTheme}"
                   VerticalAlignment="Top" Padding="5"
                  >
                            <Expander.Header>
                                <TextBlock Text="Entry tags" FontSize="13" FontWeight="UltraBold" />
                  </Expander.Header>


                            <ListView x:Name="lbTags"  
               
                AllowDrop="True" 
                Drop="lbTags_Drop"
                Margin="5,0,0,0"
                SelectionMode="Single"
                SelectionChanged="lbTags_SelectionChanged"
                MinHeight="50"
                MaxHeight="600"
                ItemTemplate="{StaticResource TagDisplay}"
                ItemContainerStyle="{StaticResource GreenItemContainer}"
                Background="{StaticResource ItemTagsBackground}"
                ToolTip="Drag tags (diagnoses and interventions) to this area to attach them to the entry"
                
                >
                                <ListView.GroupStyle>
                                    <GroupStyle HeaderTemplate="{StaticResource CareComponentHeader}" />
                                </ListView.GroupStyle>





                                <ListView.ContextMenu>
                                    <ContextMenu x:Name="ctxmTags">
                                        <MenuItem Header="Delete tag" x:Name="miDeleteTag" Click="miDeleteTag_Click"  />
                                        <MenuItem Header="Plan/Evaluate" x:Name="miManageOutcomes" Click="miManageOutcomes_Click" />

                                    </ContextMenu>
                                </ListView.ContextMenu>
                                <!-- <ListView.ItemsPanel>
           <ItemsPanelTemplate>
               <WrapPanel MaxWidth="500" />
           </ItemsPanelTemplate>
       </ListView.ItemsPanel> -->

                                <!--<ListView.View>
                <GridView x:Name="gvTagView" AllowsColumnReorder="True"   >

                        <GridViewColumn x:Name="gvcLatestOutcome"
                                        Width="10"
                                          >

                            <GridViewColumn.CellTemplate>
                                
                            </GridViewColumn.CellTemplate>

                        </GridViewColumn>
                        
                        <GridViewColumn x:Name="gvcConcept"
                                        Header="Concept" 
                                        Width="150"
                                          >

                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>

                        </GridViewColumn>
                        

                     
                    </GridView>    
               
           </ListView.View>-->
                                <ListView.Resources>
                                    <!-- Based on http://msdn2.microsoft.com/en-us/library/ms752068.aspx, accessed 12 march 2008 -->

                                    <Style x:Key="{x:Type TextBox}" TargetType="{x:Type TextBoxBase}">
                                        <Setter Property="SnapsToDevicePixels" Value="True"/>
                                        <Setter Property="OverridesDefaultStyle" Value="True"/>
                                        <Setter Property="KeyboardNavigation.TabNavigation" Value="None"/>
                                        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                        <Setter Property="MinWidth" Value="120"/>
                                        <Setter Property="MinHeight" Value="20"/>
                                        <Setter Property="AllowDrop" Value="false"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type TextBoxBase}">
                                                    <!--<Border 
          Name="Border"
          CornerRadius="2" 
          Padding="2"
          Background="{StaticResource WindowBackgroundBrush}"
          BorderBrush="{StaticResource SolidBorderBrush}"
          BorderThickness="1" >-->
                                                    <ScrollViewer Margin="0" x:Name="PART_ContentHost"/>
                                                    <!--</Border>-->
                                                    <!--<ControlTemplate.Triggers>
          <Trigger Property="IsEnabled" Value="False">
            <Setter TargetName="Border" Property="Background" Value="{StaticResource DisabledBackgroundBrush}"/>
            <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource DisabledBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource DisabledForegroundBrush}"/>
          </Trigger>
        </ControlTemplate.Triggers>-->
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>



                                </ListView.Resources>
                            </ListView>

                        </Expander>

                        <!-- Active careplan tags-->
                        <Expander x:Name="exTaxonomy" IsExpanded="False" 
          Background="{StaticResource BlueTheme}"
          Padding="5" >
                            <Expander.Header>
                                <TextBlock Text="Tags" FontSize="13" FontWeight="UltraBold" />
                  
                </Expander.Header>
                            <ListView x:Name="lbTaxonomy" MaxHeight="600" 
                SelectionChanged="lbTaxonomy_SelectionChanged"
                ItemTemplate="{StaticResource TagDisplay}"
                ItemContainerStyle="{StaticResource GreenItemContainer}"
                Background="{StaticResource CarePlanTagsBackground}" 
                Style="{DynamicResource ListViewStyleCarePlan}"
                 >
                                <ListView.GroupStyle>
                                    <GroupStyle HeaderTemplate="{StaticResource CareComponentHeader}" />
                                </ListView.GroupStyle>
                                <ListView.Resources>

                                    <!-- Based on http://msdn2.microsoft.com/en-us/library/ms752068.aspx, accessed 12 march 2008 -->

                                    <Style x:Key="{x:Type TextBox}" TargetType="{x:Type TextBoxBase}">
                                        <Setter Property="SnapsToDevicePixels" Value="True"/>
                                        <Setter Property="OverridesDefaultStyle" Value="True"/>
                                        <Setter Property="KeyboardNavigation.TabNavigation" Value="None"/>
                                        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                        <Setter Property="MinWidth" Value="120"/>
                                        <Setter Property="MinHeight" Value="20"/>
                                        <Setter Property="AllowDrop" Value="false"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type TextBoxBase}">
                                                    <!--<Border 
          Name="Border"
          CornerRadius="2" 
          Padding="2"
          Background="{StaticResource WindowBackgroundBrush}"
          BorderBrush="{StaticResource SolidBorderBrush}"
          BorderThickness="1" >-->
                                                    <ScrollViewer Margin="0" x:Name="PART_ContentHost"/>
                                                    <!--</Border>-->
                                                    <!--<ControlTemplate.Triggers>
          <Trigger Property="IsEnabled" Value="False">
            <Setter TargetName="Border" Property="Background" Value="{StaticResource DisabledBackgroundBrush}"/>
            <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource DisabledBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource DisabledForegroundBrush}"/>
          </Trigger>
        </ControlTemplate.Triggers>-->
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>

                                    <!-- Below style generated by expression blend 2.5 march preview 2008, 6 april 2008 -->
                                    <SolidColorBrush x:Key="ListBorder" Color="#FF7F9DB9"/>
                                    <Style x:Key="ListViewStyleCarePlan" TargetType="{x:Type ListView}">
                                        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"/>
                                        <Setter Property="BorderBrush" Value="{StaticResource ListBorder}"/>
                                        <Setter Property="BorderThickness" Value="1"/>
                                        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                                        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
                                        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
                                        <Setter Property="ScrollViewer.CanContentScroll" Value="true"/>
                                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type ListView}">
                                                    <StackPanel>
                                                        <Border x:Name="Bd" SnapsToDevicePixels="true" Background="{TemplateBinding Background}" 
							BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="1">
                                                            <ScrollViewer Padding="{TemplateBinding Padding}" Focusable="false">
                                                                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                                            </ScrollViewer>
                                                        </Border>
                                                        <TextBlock Text="No information has been tagged yet" x:Name="tbEmpty" Visibility="Collapsed" ToolTip="Drag some tags (diagnoses and interventions) to the tag drop area" />
						   </StackPanel>
                                                    <ControlTemplate.Triggers>
                                                        <DataTrigger Binding="{Binding Path=Items.Count,

            RelativeSource={RelativeSource Self}}" Value="0">

                                                            <Setter TargetName="tbEmpty" Property="Visibility" 

              Value="Visible" />
                                                            <Setter TargetName="Bd" Property="Visibility" Value="Collapsed" />

                                                        </DataTrigger>
                                                        <Trigger Property="IsEnabled" Value="false">
                                                            <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
                                                        </Trigger>
                                                        <Trigger Property="IsGrouping" Value="true">
                                                            <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ListView.Resources>

                            </ListView>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>

                <GridSplitter Grid.Column="3" Grid.Row="0" Width="1" Background="LightGray" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />

                <Grid Grid.Column="4" x:Name="gridRight">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>

                    </Grid.RowDefinitions>

                    <ScrollViewer  Grid.Row ="0" Grid.Column="0" 
     ScrollViewer.VerticalScrollBarVisibility="Auto" MaxHeight="600" >
                        <StackPanel>




                            <Expander x:Name="exFramework"  IsExpanded ="True" Foreground="#FF000000" Background="{DynamicResource BlueTheme}">

                                <Expander.Header>
                                    <StackPanel>
                                        <StackPanel Margin="5,0,0,0"  x:Name="spCopyright" Orientation="Horizontal">
                                            <StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock x:Name="tbFrameworkName" Text="{dat:Binding Path=Name}"  />
                                   <TextBlock Margin="5,0,0,0" x:Name="tbFrameworkVersion" Text="{dat:Binding Path=Version}"   />
                                </StackPanel>

                                                <TextBlock x:Name="tbFrameworkAuthors" Text="{dat:Binding Path=Authors}" Foreground="#FF000000" />
                               <TextBlock x:Name="tbFrameworkLastUpdate" Text="{dat:Binding Path=LastUpdate, Converter={StaticResource DateConverter}}" Foreground="#FF000000" />
                            </StackPanel>

                                            <Image x:Name="imgLogo"  Height="20" Source="{dat:Binding Path=LogoURL}" VerticalAlignment="Center"/>

                                        </StackPanel>



                                    </StackPanel>
                                </Expander.Header>

                                <StackPanel>




                                    <!-- Care Components -->

                                    <Expander  IsExpanded="True">

                                        <Expander.Header>
                                            <TextBlock Text="Care Components" Background="{StaticResource BrushFrameworkCareComponent}" /> 
                            </Expander.Header>
                                        <StackPanel>
                                            <!-- LANGAUGE attrib change 
    Norwegian: "Ingen omsorgs komponenter funnet!"
    English : "No care components found!"
    -->
                                            <Label x:Name="lblNoMatchCareComponent" Visibility="Collapsed" Content="No care components found!"/>
                                            <StackPanel x:Name="spCareComponent">

                                                <ContentControl Margin="5" x:Name="ccCareComponent"
                                             PreviewMouseLeftButtonDown="ccCareComponent_MouseDown"
                                                     >
                                                    <ContentControl.ContentTemplate>
                                                        <DataTemplate>
                                                            <Border BorderThickness="1" Background="White" x:Name="ccCareComponentBorder" 
                                                        MouseEnter="ccFrameworkElement_MouseEnter" 
                                                        MouseLeave="ccFrameworkElement_MouseLeave" >
                                                                <StackPanel>
                                                                    <TextBlock Text="{dat:Binding Path=Component}"
                                                         FontWeight="Bold" Foreground="{StaticResource CareComponentColor}" />
                                                   <TextBlock Text="{dat:Binding Path=Definition}" TextWrapping="Wrap" />
                                               </StackPanel>

                                                            </Border>

                                                        </DataTemplate>
                                                    </ContentControl.ContentTemplate>
                                                </ContentControl>



                                                <ListBox x:Name = "lbCareComponent" 
                                            Margin="5" 
					                        ScrollViewer.HorizontalScrollBarVisibility="Disabled"
						                    SelectionChanged="lbCareComponent_SelectionChanged"
                                             
					                        
                                              >
                                                    <!-- <Label FontWeight="Bold">Omsorgs komponent</Label> -->

                                                    <ListBox.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <!-- <StackPanel Orientation="Horizontal" /> -->
                                                            <WrapPanel />

                                                        </ItemsPanelTemplate>
                                                    </ListBox.ItemsPanel>
                                                    <ListBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{dat:Binding Path=Component}" 
                                                           ToolTip="{dat:Binding Path=Definition}"
                                                           Width="110" />

                                                            </DataTemplate>
                                                    </ListBox.ItemTemplate>

                                                    <ListBox.GroupStyle>
                                                        <GroupStyle>
                                                            <GroupStyle.HeaderTemplate>
                                                                <DataTemplate>
                                                                    <TextBlock FontWeight="Bold" FontSize="15"
											Text="{dat:Binding Path=Name}"/>
                                                                    </DataTemplate>
                                                            </GroupStyle.HeaderTemplate>
                                                        </GroupStyle>
                                                    </ListBox.GroupStyle>


                                                </ListBox>

                                            </StackPanel>
                                        </StackPanel>

                                    </Expander>


                                    <!-- Outcome Types -->

                                    <!-- LANGAUGE attrib change-->

                                    <Expander IsExpanded="False">
                                        <Expander.Header>
                                            <TextBlock Text="Expected outcome" Background="{StaticResource BrushFrameworkDiagnosis}" /> 
                            </Expander.Header>

                                        <StackPanel>

                                            <Border Margin="5" BorderThickness="1" 
                                    MouseEnter="ccFrameworkElement_MouseEnter"
                                    MouseLeave="ccFrameworkElement_MouseLeave"
                                    Background="White"
                                    HorizontalAlignment="Left"
                                    >
                                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                                    <ContentControl Margin="5,0,0,0" x:Name="ccOutcomeType"
                                                ContentTemplate="{StaticResource ccTemplateOutcomeType}"
                                                PreviewMouseLeftButtonDown="ccOutcomeType_MouseDown"/>
                                                    <Image Margin="5,0,0,0" Source="{dat:Binding Path=Source, ElementName=imgOutcomeType}"  Height="15" />

                                                </StackPanel>
                                            </Border>

                                            <ListBox x:Name = "lbOutcomeType"  
                                                 Margin="5"
                                                 Width="130"
						 	                    MaxHeight="300"
						 	                    HorizontalAlignment="Left"
                                         
                                         IsSynchronizedWithCurrentItem="True" 
                                     SelectionChanged="lbOutcomeType_SelectionChanged">


                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <Image x:Name="imgOutcomeType" Width="15" Height="15"  />
                                                            <TextBlock Margin="5,0,0,0" Text ="{dat:Binding Path=Concept, Converter={StaticResource RemoveParentesisOutcomeConceptConverter}}" ToolTip="{dat:Binding Path=Definition}" Padding="5,0,0,0" />
                                         
                                        </StackPanel>
                                                        <DataTemplate.Triggers>
                                                            <DataTrigger Binding="{dat:Binding Path=Code}" Value="1">
                                                                <Setter TargetName="imgOutcomeType" Property="Source" Value="Outcome Types\Improved.png" />
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{dat:Binding Path=Code}" Value="2">
                                                                <Setter TargetName="imgOutcomeType" Property="Source" Value="Outcome Types\Stabilized.png" />
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{dat:Binding Path=Code}" Value="3">
                                                                <Setter TargetName="imgOutcomeType" Property="Source" Value="Outcome Types\Worsened.png" />
                                                            </DataTrigger>
                                                        </DataTemplate.Triggers>
                                                    </DataTemplate>
                                                </ListBox.ItemTemplate>

                                            </ListBox>

                                            <CheckBox Margin="5" x:Name="cbAttachToDiagnosis" 
                                      Content="Attach to diagnosis" 
                                      IsChecked="False" 
                                      Checked="cbAttachToDiagnosis_Checked"
                                      Unchecked="cbAttachToDiagnosis_UnChecked"/>




                                        </StackPanel>

                                    </Expander>


                                    <!-- Diagnoses -->
                                    <!-- LANGAUGE attrib change-->

                                    <Expander IsExpanded="True" >
                                        <Expander.Header>
                                            <TextBlock Text="Diagnoses" Background="{StaticResource BrushFrameworkDiagnosis}" HorizontalAlignment="Stretch" /> 
                            </Expander.Header>

                                        <StackPanel>
                                            <!-- LANGAUGE attrib change-->

                                            <Label x:Name="lblNoMatchNursingDiagnoses" Visibility="Collapsed" Content="No diagnoses found!"/>


                                            <StackPanel x:Name="spNursingDiagnoses" Margin="5">

                                                <GroupBox Header="Reason">
                                                    <StackPanel Margin="5">
                                                        <Border PreviewMouseLeftButtonDown="ccNursingDiagnosis_MouseDown"
                                        MouseEnter="ccFrameworkElement_MouseEnter" 
                                        MouseLeave="ccFrameworkElement_MouseLeave"
                                        Background="White"
                                        BorderThickness="1">

                                                            <Grid Margin="5">

                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition />
                                                                </Grid.ColumnDefinitions>

                                                                <StackPanel Grid.Column="0" >


                                                                    <ContentControl  x:Name="ccNursingDiagnosis"
                                                ContentTemplate="{StaticResource ccTemplateDiagnosisAndIntervention}" 
                                                Foreground="{StaticResource DiagnosisColor}"
                                                HorizontalAlignment="Left"  />

                                                                    <StackPanel x:Name="spShowOutcome" Orientation="Horizontal" Visibility="Collapsed">
                                                                        <TextBlock Text="will" Margin="0,0,5,0" />
                                                 <TextBlock x:Name="tbShowOutcomeConcept" Text="{Binding Path=Concept, Converter={StaticResource RemoveParentesisOutcomeConceptConverter}}"  Foreground="{StaticResource DiagnosisColor}" />
                                                 <Image Margin="5,0,0,0" x:Name="imgOutcomeType" Height="15" VerticalAlignment="Center" />
                                    
                                             </StackPanel>

                                                                    <TextBlock Text="{dat:Binding Path=Text, ElementName=tbReasonDiagnosis, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" 
														FontStyle="Italic" 
														TextWrapping="Wrap" HorizontalAlignment="Left"/>
								          </StackPanel>
                                                            </Grid>
                                                        </Border>

                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition />
                                                                <ColumnDefinition Width="25" />
                                                            </Grid.ColumnDefinitions>

                                                            <TextBox  Margin="0,5" 
										x:Name="tbReasonDiagnosis" VerticalAlignment="Stretch" 
										TextChanged="tbReasonDiagnosis_TextChanged" 
										ToolTip="Enter additional information about this diagnosis" 
										TextWrapping="Wrap"
										Grid.Column="0"
										/>

                                                            <Button Grid.Column="1" x:Name="btnAcquireDiagnosticInformation" 
											HorizontalAlignment="Right" Height="20" Width="20" MaxWidth="25"   Click="btnAcquireDiagnosticInformation_Click">
                                                                <Image Source="Images/Copy.png"  ToolTip="Copy selected aquired diagnostic information" />
                                                            </Button>
                                                        </Grid>


                                                    </StackPanel>
                                                </GroupBox>

                                                <ListBox x:Name = "lbNursingDiagnosis"  
                                                 Margin="0,5,0,5"
						 	                    SelectionChanged="lbNursingDiagnosis_SelectionChanged"
							             MouseDoubleClick="lbNursingDiagnosis_MouseDoubleClick"
                                          MaxHeight="300"
                                        
                                         HorizontalAlignment="Left"
                                         IsSynchronizedWithCurrentItem="True"
                >

                                                    <!-- <Label FontWeight="Bold">Sykepleie diagnoser</Label> -->

                                                    <ListBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <TextBlock x:Name="tbConcept" Text ="{dat:Binding Path=Concept}" ToolTip="{dat:Binding Path=Definition}" Padding="5,0,0,0" />
                                                            <DataTemplate.Triggers>
                                                                <DataTrigger Binding="{dat:Binding Path=MinorCode}" Value="{x:Null}">
                                                                    <Setter Property="FontWeight" TargetName="tbConcept" Value="Bold" />
                                                                    <Setter Property="Padding" TargetName="tbConcept" Value="0" />
                                                                </DataTrigger>
                                                            </DataTemplate.Triggers>
                                                        </DataTemplate>
                                                    </ListBox.ItemTemplate>
                                                    <!--
            <ListBox.GroupStyle>
                <GroupStyle>
                    <GroupStyle.HeaderTemplate>
                        <DataTemplate>
                            <TextBlock FontWeight="Bold" FontSize="15"
                         Text="{Binding Path=Name}"/>
                        </DataTemplate>
                    </GroupStyle.HeaderTemplate>
                </GroupStyle>
            </ListBox.GroupStyle> -->
                                                </ListBox>

                                            </StackPanel>
                                        </StackPanel>
                                    </Expander>


                                    <!-- Action Types -->

                                    <!-- LANGAUGE attrib change-->

                                    <Expander IsExpanded="False" >
                                        <Expander.Header>
                                            <TextBlock Text="Action type" Background="{StaticResource BrushFrameworkIntervention}" /> 
                          </Expander.Header>

                                        <StackPanel Margin="5">

                                            <Border PreviewMouseLeftButtonDown="ccActionType_MouseDown"
                                        MouseEnter="ccFrameworkElement_MouseEnter" 
                                        MouseLeave="ccFrameworkElement_MouseLeave"
                                        Background="White"
                                        BorderThickness="1">

                                                <StackPanel Width="220"  HorizontalAlignment="Left">
                                                    <TextBlock x:Name="tbConceptActionType"  HorizontalAlignment="Left"  FontWeight="UltraBold"
										 TextWrapping="Wrap" Foreground="{StaticResource InterventionColor}" />
										<TextBlock x:Name="tbDefinitionActionType" HorizontalAlignment="Left" TextWrapping="Wrap" />
									</StackPanel>


                                            </Border>

                                            <ListBox x:Name = "lbActionType"  
                                                 Margin="0,5,0,5"
						 	                    MaxHeight="300"
                                         IsSynchronizedWithCurrentItem="True"
                                         HorizontalAlignment="Left"
                                         SelectionChanged="lbActionType_SelectionChanged"
                                                >


                                                <ListBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <TextBlock  Text ="{dat:Binding Path=Concept}" ToolTip="{dat:Binding Path=Definition}" Padding="5,0,0,0" />
                                    </DataTemplate>
                                                </ListBox.ItemTemplate>

                                            </ListBox>

                                            <StackPanel Orientation="Horizontal">
                                                <ComboBox x:Name="cbActionType" Width="100"
								 ToolTip="Select an action type" 
								 SelectionChanged="cbActionType_SelectionChanged" 
								 IsEditable="True"  />


                                                <CheckBox VerticalAlignment="Center" Margin ="5,0,0,0" x:Name="cbAttachToIntervention" 
                               Content="Attach to intervention" 
                                      IsChecked="False" Checked="cbAttachToIntervention_Checked"
                                      Unchecked="cbAttachToIntervention_UnChecked"/>

                                            </StackPanel>




                                        </StackPanel>

                                    </Expander>

                                    <!-- LANGAUGE attrib change-->

                                    <Expander IsExpanded="True" >
                                        <Expander.Header>
                                            <TextBlock Text="Interventions" Background="{StaticResource BrushFrameworkIntervention}" /> 
                            </Expander.Header>

                                        <StackPanel Margin="5">
                                            <!-- LANGAUGE attrib change-->

                                            <Label x:Name="lblNoMatchNursingInterventions" Visibility="Collapsed" Content="No interventions found!"/>
                                            <StackPanel x:Name="spNursingInterventions">

                                                <GroupBox Header="Description">
                                                    <StackPanel Margin="5">

                                                        <Border PreviewMouseLeftButtonDown="ccNursingIntervention_MouseDown"
                                        MouseEnter="ccFrameworkElement_MouseEnter" 
                                        MouseLeave="ccFrameworkElement_MouseLeave"
                                        Background="White"
                                        BorderThickness="1">

                                                            <StackPanel  Margin="5"  Background="White" >
                                                                <Grid>
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="0" x:Name="gcActionType" />
                                                                        <ColumnDefinition />
                                                                    </Grid.ColumnDefinitions>

                                                                    <TextBlock x:Name="tbNursingInterventionActionModifier" 
                                    Margin="0,0,5,0"
                                     Foreground="{StaticResource InterventionColor}" 
                                     Visibility="Collapsed" Grid.Column="0" />
									
									<TextBlock x:Name="tbNursingInterventionConcept" TextWrapping="Wrap" 
									FontWeight="UltraBold" 
									Foreground="{StaticResource InterventionColor}"
									Grid.Column="1" />
							      </Grid>

                                                                <TextBlock
							         Text="{dat:Binding Path=Text, ElementName=tbReasonIntervention, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" 
														FontStyle="Italic"
														 TextWrapping="Wrap"
													
														 />
                                </StackPanel>

                                                        </Border>

                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition />
                                                                <ColumnDefinition Width="25" />
                                                            </Grid.ColumnDefinitions>
                                                            <TextBox Grid.Column="0" 
											Margin="0,5" 
											 x:Name="tbReasonIntervention" 
											TextChanged="tbReasonIntervention_TextChanged" 
											ToolTip="Enter additional information about this intervention" 
											TextWrapping="Wrap"/>

                                                            <Button Grid.Column="1" x:Name="btnAcquireInterventionalInformation" 
				   							  HorizontalAlignment="Right" Height="20" Width="20" MaxWidth="25"   Click="btnAcquireInterventionalInformation_Click">
                                                                <Image Source="Images/Copy.png"  ToolTip="Copy selected aquired interventional information" />
                                                            </Button>
                                                        </Grid>

                                                    </StackPanel>
                                                </GroupBox>

                                                <ListBox x:Name = "lbNursingInterventions"  
                                         Margin="5"
						 	             SelectionChanged="lbNursingInterventions_SelectionChanged"
							             MouseDoubleClick="lbNursingInterventions_MouseDoubleClick"
                                         MaxHeight="300" 
                                         HorizontalAlignment="Left"
                                         IsSynchronizedWithCurrentItem="True"
                                         >


                                                    <ListBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <TextBlock x:Name="tbConceptIntervention" Text ="{dat:Binding Path=Concept}" ToolTip="{dat:Binding Path=Definition}" Padding="5,0,0,0" />
                                                            <DataTemplate.Triggers>
                                                                <DataTrigger Binding="{dat:Binding Path=MinorCode}" Value="{x:Null}">
                                                                    <Setter Property="FontWeight" TargetName="tbConceptIntervention" Value="Bold" />
                                                                    <Setter Property="Padding" TargetName="tbConceptIntervention" Value="0" />
                                                                </DataTrigger>
                                                            </DataTemplate.Triggers>
                                                        </DataTemplate>
                                                    </ListBox.ItemTemplate>
                                                    <!--
            <ListBox.GroupStyle>
                <GroupStyle>
                    <GroupStyle.HeaderTemplate>
                        <DataTemplate>
                            <TextBlock FontWeight="Bold" FontSize="15"
                         Text="{Binding Path=Name}"/>
                        </DataTemplate>
                    </GroupStyle.HeaderTemplate>
                </GroupStyle>
            </ListBox.GroupStyle> -->
                                                </ListBox>
                                            </StackPanel>
                                        </StackPanel>

                                    </Expander>
                                </StackPanel>


                            </Expander>

                        </StackPanel>
                    </ScrollViewer>





                </Grid>



                <!--</ScrollViewer>-->



                </Grid>
            </TabItem>
            
            <TabItem x:Name="tabBloodPressure" Header="Blood Pressure" >
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="0.7*" />
                        <ColumnDefinition Width="1"/>
                        <ColumnDefinition Width="0.3*"/>
                    </Grid.ColumnDefinitions>
                    <!--<Grid.RowDefinitions>
            <RowDefinition Height="250" />
            <RowDefinition Height="150" />
            <RowDefinition Height="150"/>
           
        </Grid.RowDefinitions>-->

                    <StackPanel Grid.Column="0" Grid.Row="0">
                        <ListView x:Name="lvBP"  HorizontalAlignment="Left" >

                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Width="130"
        DisplayMemberBinding="{Binding Time}"
        Header="Time" />

                                    <GridViewColumn Width="50" 
        DisplayMemberBinding="{Binding SystolicBP}"
        Header="Systolic"  />
                                    <GridViewColumn Width="50"
        DisplayMemberBinding="{Binding DiastolicBP}"
        Header="Diastolic" />
                                    <GridViewColumn Width="50"
        DisplayMemberBinding="{Binding Pulse}"
        Header="Pulse" />

                                    <GridViewColumn  
        DisplayMemberBinding="{Binding Comment}"
        Header="Comment" />
                                </GridView>
                            </ListView.View>

                        </ListView>
                    
                        <FlowDocumentReader x:Name="frBloodpressure" Grid.Column="0" Grid.Row="0" Margin="5" Height="600">
                            <FlowDocumentReader.Document>
                                <FlowDocument>
                                    <Paragraph>
                                        <Figure Width="0.5Page">
                                            <BlockUIContainer>
                                                <Image  x:Name="img" Margin="5" />

                                            </BlockUIContainer>
                                        </Figure>
                                    </Paragraph>
                                </FlowDocument>
                            </FlowDocumentReader.Document>
                            </FlowDocumentReader>

                    </StackPanel>
                    
                    <GridSplitter Grid.Column="1" Grid.Row="0" Width="1" Background="LightGray" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
                    
                    <StackPanel Grid.Column="2" Grid.Row="0"  Background="{StaticResource BlueTheme}" Margin="5" >
                        <Expander Header="Average" IsExpanded="True">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="70" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Image Grid.Column="0" Grid.Row="0" x:Name="imgSystolicAverage" Margin="5" VerticalAlignment="Center" HorizontalAlignment="Center"  />
                            <Image Grid.Column="1" Grid.Row="0" x:Name="imgDiastolicAverage" Margin="5" VerticalAlignment="Center" HorizontalAlignment="Center"   />
                            <Image Grid.Column="2" Grid.Row="0"  x:Name="imgPulseAverage" Margin="5"  VerticalAlignment="Center"  HorizontalAlignment="Center" />

                            <Label Content="Systolic SBP" Grid.Row="1" Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            <Label Content="Diastolic DBP" Grid.Row="1" Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            <Label Content="Pulse HR" Grid.Row="1" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center" />

                        </Grid>

                    </Expander>



                    <Expander Header="Chart" IsExpanded="True">
                        <!--<StackPanel>
                            <Image  x:Name="img" Margin="5" />

                        </StackPanel>-->

                    </Expander>

                    <Expander  Header="Time and display options" IsExpanded="False">
                        <StackPanel Margin="5">
                           

                            <GroupBox Header="Display options" Padding="5" x:Name="gbDisplayOptions">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <CheckBox x:Name="cbShowSystolicBP"  Content="Systolic SBP" IsChecked="{Binding Path=ShowSystolicBP, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Click="cbDisplayOptionsChanged_Click"  />
                                    <CheckBox x:Name="cbShowDisastolicBP" Margin="5,0,0,0" Content="Diastolic DBP" IsChecked="{Binding Path=ShowDiastolicBP, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Click="cbDisplayOptionsChanged_Click" />
                                    <CheckBox x:Name="cbShowPulseHr" Margin="5,0,0,0" Content="Pulse HR" IsChecked="{Binding Path=ShowPulseHR, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Click="cbDisplayOptionsChanged_Click" />
                                    <CheckBox x:Name="cbShowLabels" Margin="5,0,0,0" Content="Show labels" IsChecked="{Binding Path=ShowLabels, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Click="cbDisplayOptionsChanged_Click" />

                                </StackPanel>

                            </GroupBox>
                        </StackPanel>
                    </Expander>




                        <GroupBox Grid.Row="2" Header="New measurement" Margin="5">
                            <Grid  Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="70" />
                                    <ColumnDefinition Width="34.684" />
                                    <ColumnDefinition Width="251" />
                                    <ColumnDefinition Width="37.909*" />
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition Height="35"  />
                                    <RowDefinition Height="35"/>
                                    <RowDefinition Height="35"/>
                                    <RowDefinition Height="50"/>
                                    <RowDefinition Height="35"/>
                                    <RowDefinition Height="35"/>
                                    <RowDefinition Height="35"/>

                                </Grid.RowDefinitions>


                                <Label Grid.Row="0" Grid.Column="0" FontWeight="UltraBold" Foreground="{StaticResource colorSystolic}"
                       Content="Systolic" VerticalAlignment="Center"
                       ToolTip="Systolic blood pressure (mmHg) SBP" HorizontalAlignment="Right"  />

                                <TextBox Grid.Row="0" Grid.Column="1" IsReadOnly="True"  BorderThickness="0" Foreground="{StaticResource colorSystolic}" x:Name="tbSystolicBP" VerticalAlignment="Center"
                         Text="{Binding ElementName=sliderSystolic, Path=Value, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource RoundSliderConverter}}" 
                         HorizontalAlignment="Right">
                                    <TextBox.Style>


                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=cbSystolicBP, Path=IsChecked, UpdateSourceTrigger=PropertyChanged}" Value="False">
                                                    <Setter Property="TextBox.Visibility"  Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>

                                        </Style>

                                    </TextBox.Style>

                                </TextBox>

                                <Slider Grid.Row="0" Grid.Column="2" x:Name="sliderSystolic" Minimum="0" Maximum="250" VerticalAlignment="Center"
                AutoToolTipPlacement="BottomRight" IsEnabled="{Binding ElementName=cbSystolicBP, Path=IsChecked, UpdateSourceTrigger=PropertyChanged}"
                Value="120"
                ToolTip="Systolic blood pressure measurement" TickFrequency="20"
                TickPlacement="BottomRight" LargeChange="5"
                 ValueChanged="sliderSystolic_ValueChanged" />

                                <!--<Rectangle Width="50" 
                           Height="{Binding ElementName=sliderSystolic, Path=Value, UpdateSourceTrigger=PropertyChanged}"
                           Fill="{StaticResource colorSystolic}"
                               VerticalAlignment="Bottom"
                           >

                        <Rectangle.RenderTransform>
                            <ScaleTransform ScaleY="0.5" />

                        </Rectangle.RenderTransform>


                    </Rectangle>-->

                                <CheckBox Grid.Row="0" Grid.Column="3"   
                      VerticalAlignment="Center" 
                      x:Name="cbSystolicBP" 
                      IsChecked="True" 
                      ToolTip="Check if reading is valid"
                      HorizontalAlignment="Center" />

                                <Label Grid.Row="1" Grid.Column="0" FontWeight="UltraBold" Foreground="{StaticResource colorDiastolic}" 
                       Content="Diastolic" VerticalAlignment="Center"
                       ToolTip="Diastolic blood pressure (mmHg) DBP" HorizontalAlignment="Right" />

                                <TextBox IsReadOnly="True" Grid.Column="1" Grid.Row="1" BorderThickness="0" Foreground="{StaticResource colorDiastolic}" x:Name="tbDiastolicBP" VerticalAlignment="Center" 
                         Text="{Binding ElementName=sliderDiastolic, Path=Value, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource RoundSliderConverter}}"  HorizontalAlignment="Right" >

                                    <TextBox.Style>


                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=cbDiastolicBP, Path=IsChecked, UpdateSourceTrigger=PropertyChanged}" Value="False">
                                                    <Setter Property="TextBox.Visibility"  Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>

                                        </Style>

                                    </TextBox.Style>

                                </TextBox>

                                <Slider Grid.Column="2" Grid.Row="1" x:Name="sliderDiastolic" Minimum="0" Maximum="250" 
                AutoToolTipPlacement="BottomRight" VerticalAlignment="Center"
                Value="70" IsEnabled="{Binding ElementName=cbDiastolicBP, Path=IsChecked, UpdateSourceTrigger=PropertyChanged}"
                ToolTip="Diastolic blood pressure measurement" TickFrequency="20"
                TickPlacement="BottomRight" 
                    ValueChanged="sliderDiastolic_ValueChanged"
                 LargeChange="5"   />

                                <!--<Rectangle Width="50" 
                           Height="{Binding ElementName=sliderSystolic, Path=Value, UpdateSourceTrigger=PropertyChanged}"
                           Fill="{StaticResource colorSystolic}"
                               VerticalAlignment="Bottom"
                           >

                        <Rectangle.RenderTransform>
                            <ScaleTransform ScaleY="0.5" />

                        </Rectangle.RenderTransform>


                    </Rectangle>-->


                                <CheckBox Grid.Row="1" Grid.Column="3" 
                      VerticalAlignment="Center" 
                      x:Name="cbDiastolicBP"  
                      IsChecked="True"
                      
                      ToolTip="Check if reading is valid"
                      HorizontalAlignment="Center"
                      />


                                <Label Grid.Row="2" FontWeight="UltraBold" Foreground="{StaticResource colorPulse}" 
                       Content="Pulse" VerticalAlignment="Center"
                       ToolTip="Pulse or heart rate (HR)" HorizontalAlignment="Right"  />

                                <TextBox IsReadOnly="True" Grid.Column="1" Grid.Row="2" BorderThickness="0" x:Name="tbPulseHR" Foreground="{StaticResource colorPulse}"  VerticalAlignment="Center"
                         Text="{Binding ElementName=sliderPulseHR, Path=Value, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource RoundSliderConverter}}"  
                     HorizontalAlignment="Right">
                                    <TextBox.Style>


                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ElementName=cbPulseHR, Path=IsChecked, UpdateSourceTrigger=PropertyChanged}" Value="False">
                                                    <Setter Property="TextBox.Visibility"  Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>

                                        </Style>

                                    </TextBox.Style>


                                </TextBox>

                                <Slider Grid.Column="2" Grid.Row="2" x:Name="sliderPulseHR" Minimum="0" Maximum="250" 
                AutoToolTipPlacement="BottomRight" VerticalAlignment="Center"
                Value="60" IsEnabled="{Binding ElementName=cbPulseHR, Path=IsChecked, UpdateSourceTrigger=PropertyChanged}"
                ToolTip="Pulse or heart rate (HR)" TickFrequency="20"
                TickPlacement="BottomRight" 
                LargeChange="5"    />

                                <!--<Rectangle Width="50" 
                           Height="{Binding ElementName=sliderSystolic, Path=Value, UpdateSourceTrigger=PropertyChanged}"
                           Fill="{StaticResource colorSystolic}"
                               VerticalAlignment="Bottom"
                           >

                        <Rectangle.RenderTransform>
                            <ScaleTransform ScaleY="0.5" />

                        </Rectangle.RenderTransform>


                    </Rectangle>-->


                                <CheckBox Grid.Row="2" Grid.Column="3" 
                      VerticalAlignment="Center"
                      x:Name="cbPulseHR"
                      IsChecked="True" 
                      ToolTip="Check if reading is valid"
                      HorizontalAlignment="Center" />

                                <Label Grid.Row="3" FontWeight="UltraBold"   
                       Content="Comment" VerticalAlignment="Center"
                       ToolTip="Pulse or heart rate (HR)" HorizontalAlignment="Right" />

                                <TextBox x:Name="tbComment"
                     Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="3"
                     TextWrapping="Wrap"
                      />

                                <Label Grid.Row="4" FontWeight="UltraBold"  
                       Content="Date" VerticalAlignment="Center"
                       ToolTip="Date of measurement" HorizontalAlignment="Right" />


                                <dc:DatePicker x:Name="dpDate" Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2" 
                               HorizontalAlignment="Left" Width="100"  NullValueText="Enter date"
                               VerticalAlignment="Center"/>


                                <Label Grid.Row="5" FontWeight="UltraBold"   
                       Content="Time" VerticalAlignment="Center"
                       ToolTip="Time of measurement" HorizontalAlignment="Right" />


                                <ac:TimePicker x:Name="tpTime" Grid.Row="5" Grid.Column="1" Grid.ColumnSpan="2"
                               HorizontalAlignment="Left" Width="100" VerticalAlignment="Center"  />



                                <Button x:Name="btnAddBPReading" Grid.Column="1" Grid.Row="6" ToolTip="Save reading to database" 
                        HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"
                        HorizontalAlignment="Stretch"
                        Click="btnAddBPReading_Click"
                        >
                                    <Image Source="Images/Save.png" />
                                </Button>

                                <TextBlock Grid.Row="6" Grid.Column="2" x:Name="tbStatusBP" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,0,0"  />
                    
               
                
               
            </Grid>


                        </GroupBox>
                </StackPanel>

           
                </Grid>    
            </TabItem>
            
            <TabItem Header="Family" />
            
            <TabItem Header="Respiration" />
            
            <TabItem Header="Temperature" />

            <TabItem Header="Glucose" />

            <TabItem Header="Medications" />
            
            
        </TabControl>
        <StatusBar x:Name="sbStatus">
            <StatusBarItem>
                <TextBlock x:Name="tbUserName" />
            </StatusBarItem>
            
            
        </StatusBar>
        
   </StackPanel>
</Window>
